<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Endless Jumper - Improved Base</title>
<style>
  body {
    margin: 0;
    background: #87CEEB;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  #game {
    position: relative;
    width: 480px;   /* Bigger game area */
    height: 854px;  /* 16:9 ratio */
    background: #bde0fe;
    overflow: hidden;
    border: 2px solid #000;
  }
  .player {
    position: absolute;
    width: 50px;
    height: 60px;
    background: red;
  }
  .platform {
    position: absolute;
    width: 120px;
    height: 20px;
    background: green;
  }
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    font: bold 22px Arial;
    color: #000;
    z-index: 10;
  }
</style>
</head>
<body>

<div id="game">
  <div id="score">Score: 0</div>
  <div class="player" id="player"></div>
</div>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const scoreDisplay = document.getElementById("score");

const gameWidth = 480;
const gameHeight = 854;
let platforms = [];
let score = 0;

// Player physics
let px = gameWidth / 2 - 25;
let py = 100;
let vx = 0;
let vy = 0;
let gravity = -0.45;
let jumpStrength = 14; // Higher jump
let moveSpeed = 4;
let onGround = false;

// Scroll mechanics
let cameraY = 0; // How much the world has shifted up
let scrollSpeed = 0; // Starts at 0 until triggered
let spawnGapY = 150;
let maxVerticalGap = 180; // Max jumpable gap
let maxHorizontalGap = 150;

// Controls
let keys = { left: false, right: false, jump: false };

document.addEventListener("keydown", e => {
  if (e.code === "ArrowLeft" || e.code === "KeyA") keys.left = true;
  if (e.code === "ArrowRight" || e.code === "KeyD") keys.right = true;
  if (e.code === "Space" || e.code === "ArrowUp") keys.jump = true;
});
document.addEventListener("keyup", e => {
  if (e.code === "ArrowLeft" || e.code === "KeyA") keys.left = false;
  if (e.code === "ArrowRight" || e.code === "KeyD") keys.right = false;
  if (e.code === "Space" || e.code === "ArrowUp") keys.jump = false;
});

function createPlatform(x, y) {
  const el = document.createElement("div");
  el.className = "platform";
  el.style.left = x + "px";
  el.style.bottom = y + "px";
  game.appendChild(el);
  platforms.push({ x, y, width: 120, height: 20, el });
}

function initPlatforms() {
  platforms.forEach(p => p.el.remove());
  platforms = [];
  let startY = 50;
  for (let i = 0; i < 8; i++) {
    createPlatform(Math.random() * (gameWidth - 120), startY);
    startY += spawnGapY;
  }
}
initPlatforms();

function resetGame() {
  px = gameWidth / 2 - 25;
  py = 100;
  vx = 0;
  vy = 0;
  score = 0;
  cameraY = 0;
  scrollSpeed = 0;
  spawnGapY = 150;
  initPlatforms();
}

function update() {
  // Movement input
  if (keys.left) vx = -moveSpeed;
  else if (keys.right) vx = moveSpeed;
  else vx = 0;

  // Jump
  if (keys.jump && onGround) {
    vy = jumpStrength;
    onGround = false;
  }

  // Apply gravity
  vy += gravity;

  // Move player
  px += vx;
  py += vy;

  // Keep inside screen horizontally
  if (px < 0) px = 0;
  if (px > gameWidth - 50) px = gameWidth - 50;

  // Collision check
  onGround = false;
  for (let p of platforms) {
    if (
      vy <= 0 &&
      px + 50 > p.x &&
      px < p.x + p.width &&
      py > p.y &&
      py < p.y + p.height &&
      py - vy >= p.y + p.height
    ) {
      py = p.y + p.height;
      vy = 0;
      onGround = true;
    }
  }

  // Scroll trigger
  if (py - cameraY > gameHeight / 2) {
    cameraY = py - gameHeight / 2;
    scrollSpeed = 2; // Start scrolling
  }

  // Move platforms relative to camera
  platforms.forEach(p => {
    p.el.style.bottom = (p.y - cameraY) + "px";
  });

  // Remove off-screen platforms & spawn new ones
  platforms = platforms.filter(p => p.y - cameraY > -20);

  while (platforms.length < 8) {
    let highestY = Math.max(...platforms.map(p => p.y));
    let newY = highestY + Math.random() * (maxVerticalGap - 100) + 100;
    let newX = Math.max(
      0,
      Math.min(gameWidth - 120, platforms[platforms.length - 1].x + (Math.random() * (maxHorizontalGap * 2) - maxHorizontalGap))
    );
    createPlatform(newX, newY);
    score++;
    scoreDisplay.textContent = "Score: " + score;

    // Increase difficulty
    if (score % 10 === 0) {
      maxVerticalGap += 5;
      scrollSpeed += 0.2;
    }
  }

  // Game over
  if (py - cameraY < -50) {
    resetGame();
  }

  // Update player position
  player.style.left = px + "px";
  player.style.bottom = (py - cameraY) + "px";

  requestAnimationFrame(update);
}

update();
</script>

</body>
</html>
