<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Endless Jumper (Base)</title>
<style>
  body {
    margin: 0;
    background: #87CEEB;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  #game {
    position: relative;
    width: 360px;
    height: 640px;
    background: #bde0fe;
    overflow: hidden;
    border: 2px solid #000;
  }
  .player {
    position: absolute;
    width: 40px;
    height: 50px;
    background: red;
    bottom: 100px;
    left: 160px;
  }
  .platform {
    position: absolute;
    width: 100px;
    height: 20px;
    background: green;
  }
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    font: bold 20px Arial;
    color: #000;
    z-index: 10;
  }
</style>
</head>
<body>

<div id="game">
  <div id="score">Score: 0</div>
  <div class="player" id="player"></div>
</div>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const scoreDisplay = document.getElementById("score");

const gameWidth = 360;
const gameHeight = 640;
let platforms = [];
let score = 0;

// Player physics
let px = 160;
let py = 100;
let vx = 0;
let vy = 0;
let gravity = -0.4;
let jumpStrength = 10;
let moveSpeed = 3;
let onGround = false;

// Scroll
let scrollSpeed = 1;
let spawnGapY = 120;

// Controls
let keys = { left: false, right: false, jump: false };

document.addEventListener("keydown", e => {
  if (e.code === "ArrowLeft" || e.code === "KeyA") keys.left = true;
  if (e.code === "ArrowRight" || e.code === "KeyD") keys.right = true;
  if (e.code === "Space" || e.code === "ArrowUp") keys.jump = true;
});
document.addEventListener("keyup", e => {
  if (e.code === "ArrowLeft" || e.code === "KeyA") keys.left = false;
  if (e.code === "ArrowRight" || e.code === "KeyD") keys.right = false;
  if (e.code === "Space" || e.code === "ArrowUp") keys.jump = false;
});

function createPlatform(x, y) {
  const el = document.createElement("div");
  el.className = "platform";
  el.style.left = x + "px";
  el.style.bottom = y + "px";
  game.appendChild(el);
  platforms.push({ x, y, width: 100, height: 20, el });
}

// Initial platforms
function initPlatforms() {
  platforms.forEach(p => p.el.remove());
  platforms = [];
  let startY = 50;
  for (let i = 0; i < 7; i++) {
    createPlatform(Math.random() * (gameWidth - 100), startY);
    startY += spawnGapY;
  }
}
initPlatforms();

function resetGame() {
  px = 160;
  py = 100;
  vx = 0;
  vy = 0;
  score = 0;
  scrollSpeed = 1;
  initPlatforms();
}

function update() {
  // Movement input
  if (keys.left) vx = -moveSpeed;
  else if (keys.right) vx = moveSpeed;
  else vx = 0;

  // Jump
  if (keys.jump && onGround) {
    vy = jumpStrength;
    onGround = false;
  }

  // Apply gravity
  vy += gravity;

  // Move player
  px += vx;
  py += vy;

  // Keep inside screen horizontally
  if (px < 0) px = 0;
  if (px > gameWidth - 40) px = gameWidth - 40;

  // Scroll platforms down
  py -= scrollSpeed;
  platforms.forEach(p => {
    p.y -= scrollSpeed;
    p.el.style.bottom = p.y + "px";
  });

  // Collision check
  onGround = false;
  for (let p of platforms) {
    if (
      vy <= 0 &&
      px + 40 > p.x &&
      px < p.x + p.width &&
      py > p.y &&
      py < p.y + p.height &&
      py - vy >= p.y + p.height
    ) {
      py = p.y + p.height;
      vy = 0;
      onGround = true;
    }
  }

  // Remove off-screen platforms & spawn new ones
  platforms = platforms.filter(p => {
    if (p.y < -20) {
      p.el.remove();
      return false;
    }
    return true;
  });

  while (platforms.length < 7) {
    let highestY = Math.max(...platforms.map(p => p.y));
    let newY = highestY + spawnGapY;
    let newX = Math.random() * (gameWidth - 100);
    createPlatform(newX, newY);
    score++;
    scoreDisplay.textContent = "Score: " + score;

    // Increase difficulty
    if (score % 10 === 0) {
      spawnGapY += 5; // slightly more vertical gap
      scrollSpeed += 0.1; // faster scroll
    }
  }

  // Game over
  if (py < -50) {
    resetGame();
  }

  // Update player position
  player.style.left = px + "px";
  player.style.bottom = py + "px";

  requestAnimationFrame(update);
}

update();
</script>

</body>
</html>
